ECON 2007: Quant Econ and Econometrics
Serial Correlation and Heteroskedasticity

Dr. √Åureo de Paula
Department of Economics
University College London

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

1 / 27

What of OLS with Serially Correlated Errors?

I

Unbiasedness: TS.1-TS.3 regardless of serial correlation!

I

Consistency: TS.1‚Äô-TS.3‚Äô regardless of serial correlation!

I

Lack of serial correlation TS.5 and TS.5‚Äô was invoked to obtain
standard errors and necessary to show that OLS was B(est)
L(inear) U(nbiased) E(stimator).

I

With serial correlation, OLS is no longer BLUE.

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

2 / 27

Variance of OLS under Serial Correlation
I

To see how the variance of OLS is affected, imagine that
ut = œÅut‚àí1 + et ,

t = 1, . . . , n

with |œÅ| < 1 and et , iid with mean zero and variance œÉ 2 .
I

Now consider the simple static linear regression:
yt = Œ≤0 + Œ≤1 xt + ut .

I

In this case, remember that
Pn
Pn
(xt ‚àí x)ut
t=1 (xt ‚àí x)ut
Œ≤ÃÇ1 = Œ≤1 + Pn
= Œ≤1 + t=1
2
SSTx
t=1 (xt ‚àí x)

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

3 / 27

Variance of OLS under Serial Correlation
I

The variance of the OLS estimator (conditional on x1 , . . . , xT ) is
then given by
Var (Œ≤ÃÇ1 ) =

I

Var (

PT

t=1 (xt ‚àí
SSTx2

x)ut )

If n = 2 and Var (ut ) = œÉu2 , the above becomes
P2

t=1 (xt

de Paula (UCL)

‚àí x)2 œÉu2 + 2(x1 ‚àí x)(x2 ‚àí x)Cov (u1 , u2 )
SSTx2

ECON 2007: Quantitative Economics and Econometrics

4 / 27

Variance of OLS under Serial Correlation

I

Since Cov (u1 , u2 ) = œÅœÉu2 , we have that
Var (Œ≤ÃÇ1 ) =

I

œÉ 2 œÅ(x1 ‚àí x)(x2 ‚àí x)
œÉu2
+2 u
SSTx
SSTx2

If n > 2 the formula can be shown to equal
2

œÉu
œÉu2
Var (Œ≤ÃÇ1 ) =
+2
SSTx

de Paula (UCL)

PT ‚àí1 PT ‚àít
t=1

j=1

œÅj (xt ‚àí x)(xt+j ‚àí x)

SSTx2

ECON 2007: Quantitative Economics and Econometrics

5 / 27

Variance of OLS under Serial Correlation

I

When œÅ = 0 (no serial correlation), the previous formula coincides
with the usual formula for the variance of the OLS estimator
variance.

I

Otherwise, the usual formula may over- or under-estimate the
variance of the coefficient estimator.

I

If œÅ > 0 and xt is positively correlated through time, the usual
formula will underestimate the variance.

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

6 / 27

OLS with Lag Dependent Variables

I

If xt contains a lag dependent variable, TS.3 no longer holds (even
when there is no serial correlation) and OLS is not unbiased.

I

When there is no serial correlation, OLS may still be consistent
provided TS.3‚Äô holds.

I

Even when there is serial correlation, as long as TS.1‚Äô-TS.3‚Äô hold,
OLS is consistent.

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

7 / 27

OLS with Lag Dependent Variables
I

For example, take
E(yt |yt‚àí1 ) = Œ≤0 + Œ≤1 yt‚àí1
with |Œ≤1 | < 1 (TS.1‚Äô holds). Let
ut = yt ‚àí E(yt |yt‚àí1 )
Because E(ut |yt‚àí1 ) = 0, TS.3‚Äô holds and OLS is consistent
(provided TS.2‚Äô also holds). In this case,
Cov (ut , ut‚àí1 ) = Cov (ut , yt‚àí1 ‚àí Œ≤0 ‚àí Œ≤1 yt‚àí2 ) = ‚àíŒ≤1 Cov (ut , yt‚àí2 )
which needs not be zero.

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

8 / 27

OLS with Lag Dependent Variables
I

In other circumstances, serial correlation and a lagged dependent
variable may invalidate TS.3‚Äô.

I

For instance, let
yt = Œ≤0 + Œ≤1 yt‚àí1 + ut
and
ut = œÅut‚àí1 + et
where E(et |ut‚àí1 , ut‚àí2 , . . . ) = E(et |yt‚àí1 , yt‚àí2 , . . . ) = 0.

I

In this case,
Cov (ut , yt‚àí1 ) = œÅCov (ut‚àí1 , yt‚àí1 ) 6= 0
unless œÅ = 0 (because yt‚àí1 = Œ≤0 + Œ≤1 yt‚àí2 + ut‚àí1 ).

I

OLS would not be consistent then.
de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

9 / 27

OLS with Lag Dependent Variables
I

But in this case, notice that
yt

= Œ≤0 + Œ≤1 yt‚àí1 + ut
= Œ≤0 + Œ≤1 yt‚àí1 + œÅut‚àí1 + et
= Œ≤0 + Œ≤1 yt‚àí1 + œÅ(yt‚àí1 ‚àí Œ≤0 ‚àí Œ≤1 yt‚àí2 ) + et
= Œ±0 + Œ±1 yt‚àí1 + Œ±2 yt‚àí2 + et

where Œ±0 = Œ≤0 (1 ‚àí œÅ), Œ±1 = Œ≤1 + œÅ and Œ±2 = œÅŒ≤1 .
I

Since et is uncorrelated with yt‚àí1 and yt‚àí2 the OLS estimator for
the above model would be consistent!

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

10 / 27

OLS with Lag Dependent Variables

‚ÄúYou need a good reason for having both a lagged dependent
variable in a model and a particular model of serial correlation
in the errors. Often serial correlation in the errors of a
dynamic model simply indicates that the dynamic regression
function has not been completely specified.‚Äù (p.412)

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

11 / 27

Testing for Serial Correlation
I

How can we test for serial correlation in the residual of
yt = Œ≤0 + Œ≤1 x1t + ¬∑ ¬∑ ¬∑ + Œ≤k xkt + ut

I

The most common form of serial correlation in the literature is an
AR(1) structure: ut = œÅut‚àí1 + et . We will investigate a few tests of
the null hypothesis:
H0 : œÅ = 0

I

We discuss tests when x1t , . . . , xkt are ( 1 ) strictly exogenous and
( 2 ) when they are no strictly exogenous.

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

12 / 27

Testing for Serial Correlation: Strictly Exogenous
Regressors

I

Here we assume that E(et |ut‚àí1 , ut‚àí2 , . . . ) = 0 and
Var (et |ut‚àí1 ) = Var (et ) = œÉ 2 .

I

If we observed ut one could simply test H0 by regressing ut on
ut‚àí1 . Given our assumptions this test would be valid in large
samples (i.e., asymptotically).

I

We do not observe ut , but we can estimate it!

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

13 / 27

Testing for Serial Correlation with Strictly Exogenous
Regressors
I

So, to test for AR(1) serial correlation we
1. Regress yt on x1t , . . . , xkt and save the estimated residuals uÃÇt .
2. Regress uÃÇt on uÃÇt‚àí1 and obtain a coefficient estimate œÅÃÇ and its t-stat
tœÅÃÇ .
3. Use tœÅÃÇ to test H0 .

I

Any source of serial correlation that causes adjacent errors ut to
be correlated can be detected using this test.

I

Beware of numerical versus statistical significance when sample
size is large (not likely in many applications).

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

14 / 27

Testing for Serial Correlation with Strictly Exogenous
Regressors
I

Another test for AR(1) serial correlation relies on the
Durbin-Watson statistic:
PT
(uÃÇt ‚àí uÃÇt‚àí1 )2
DW = t=2PT
‚âà 2(1 ‚àí œÅÃÇ)
2
t=1 uÃÇt

I

The distribution of this test statistic (conditional on regressors)
depends on the explanatory variables, the sample size, the
number of regressors and whether the regression contains an
intercept.

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

15 / 27

Testing for Serial Correlation with Strictly Exogenous
Regressors
I

Instead of tabulating critical values for all these scenarios, two
thresholds (dU and dL ) are usually presented for a test of H0
agains H1 : œÅ > 0 at a given signicance level.

I

For example, when n = 45, k = 4 and the significance level is 5%,
dL = 1.336 and dU = 1.720.

I

When H0 is true, DW ‚âà 2. If DW > dU , we fail to reject H0 . If
DW < dL , we reject H0 in favor of the alternative. When
dL < DW < dU , the test is inconclusive.

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

16 / 27

Testing for Serial Correlation without Strictly
Exogenous Regressors
I

Without strict exogeneity, at least one xt is correlated with ut‚àí1 .

I

When this is the case, Durbin (1970) suggested an alternative
testing procedure that proceeds as follows:
1. Run OLS of yt on x1t , . . . , xkt and obtain the residuals uÃÇt .
2. Run the regression of uÃÇt on x1t , . . . , xkt and uÃÇt‚àí1 and obtain the
coefficient œÅÃÇ on uÃÇt‚àí1 and its t statistic, tœÅÃÇ .
3. Use tœÅÃÇ to test H0 .

I

x1t , . . . , xkt may contain lagged dependent variables and other
nonstrictly exogenous explanatory variables.

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

17 / 27

Testing for Serial Correlation without Strictly
Exogenous Regressors

I

Because uÃÇt = yt ‚àí Œ≤ÃÇ0 ‚àí Œ≤ÃÇ1 x1t ‚àí ¬∑ ¬∑ ¬∑ ‚àí Œ≤ÃÇk xkt , the t-stat is the same if
we replace uÃÇt with yt in step 2 above.

I

Heteroskedasticity of unknown form can be accomodated by using
heteroskedasticity-robust t stats.

I

The test can be modified to test for higher order serial correlation
(e.g., ut = œÅ1 ut‚àí1 + œÅ2 ut‚àí2 ).

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

18 / 27

Serial Correlation-Robust Inference with OLS
I

OLS can be more robust than estimators that allow for serial
correlation (see book). We need nevertheless to use appropriate
standard errors.

I

In the simple linear regression model
yt = Œ≤0 + Œ≤1 xt + ut ,
remember that we have
PT
PT
rt ut
t=1 (xt ‚àí x)ut
= Œ≤1 + Pt=1
Œ≤ÃÇ1 = Œ≤1 + PT
T
2
2
t=1 (xt ‚àí x)
t=1 rt
and the variance of Œ≤ÃÇ1 (given xt , t = 1, . . . , T ) is
P ‚àí1
P
TVar (at ) + 2 Tj=1
(T ‚àí j)Cov (at , at‚àíj )
Var ( Tt=1 at )
P
2 =
P
2
T
T
2
2
t=1 rt
t=1 rt
where rt = xt ‚àí x and at = rt ut .
de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

19 / 27

Serial Correlation-Robust Inference with OLS

I

This can be further simplified to:
TVar (at )
v
P
2 √ó
Var (at )
T
2
t=1 rt

P ‚àí1
where v = Var (at ) + 2 Tj=1

I



T ‚àíj
T Cov (at , at‚àíj )

.

Notice that the first term is the usual robust variance for the
estimator.

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

20 / 27

Serial Correlation-Robust Inference with OLS
I

This can be generalized to a multiple linear regression.

I

In the linear regression model
yt = Œ≤0 + Œ≤1 x1t + ¬∑ ¬∑ ¬∑ + Œ≤k xkt + ut ,
the standard error for the coefficient estimator Œ≤ÃÇ1 can be shown to
be equal to
Avar (Œ≤ÃÇ1 ) =

T
X
t=1

!‚àí2
E(rt2 )

Var

T
X

!
rt ut

t=1

where rt is the residual in
x1t = Œ¥0 + Œ¥2 x2t + ¬∑ ¬∑ ¬∑ + Œ¥k xkt + rt
de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

21 / 27

Serial Correlation-Robust Inference with OLS
I

This variance can be estimated as follows:
1. Regress x1t on x2t , . . . , xkt and save the residuals rÃÇt .
2. For some integer g, compute
vÃÇ =

T
X
t=1

aÃÇt2

+2

g
X
h=1

[1 ‚àí h/(g + 1)]

T
X

!
aÃÇt aÃÇt‚àíh

t=1

where aÃÇt = rÃÇt uÃÇt .
3. The heteroskedasticity and autocorrelation robust standard error is
then
‚àö
[‚Äúse(Œ≤ÃÇ1 )‚Äù/œÉÃÇ]2 vÃÇ .
I

where ‚Äúse(Œ≤ÃÇ1 )‚Äù denote the usual OLS standard error.
This obtains as the variance formula (in the simple regression)
can also be written as:
Ô£´P
 PT 2  Ô£∂2
ut2 /T
t=1 rt
Ô£≠
Ô£∏ √ó Tv
P 2
ut /T
de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

22 / 27

Serial Correlation-Robust Inference with OLS
I

The corrected standard errors will perform better in large samples.

I

One needs to choose g! Newey and West (1987) recommend (the
integer part of) 4(n/100)2/9 .

I

With strong serial correlation OLS can be very inefficient. In this
case it might make sense to first difference the data before
estimation:
‚àÜyt = Œ≤1 ‚àÜxt + ‚àÜut .
(With AR(1) residuals, this will typically eliminate most of the serial
correlation when œÅ is large and positive.)

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

23 / 27

Heteroskedasticity
I

Heteroskedasticity would not cause bias or inconsistency and
HAC standard errors can be used for inference.

I

Some forms of heteroskedasticity are nevertheless interesting in
their own. Especially that implied by autoregressive conditional
heteroskedasticity (ARCH) models and their generalizations.

I

These models postulate something like
2
E(ut2 |ut‚àí1 , ut‚àí2 , . . . ) = Œ±0 + Œ±1 ut‚àí1

whereby the variance of the residuals changes dynamically.
I

Notice that conditions TS.1‚Äô-TS.5‚Äô may still hold and inference with
OLS is still correct.

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

24 / 27

Heteroskedasticity

I

We might nonetheless be able to get asymptotically more efficient
estimators if we exploit the particular nature of the
heteroskedasticity.

I

This particular form of heteroskedasticity is also of great interest
for its connection with the analysis of volatility dynamics.

I

It was originally used to investigate the behavior of inflation in the
UK for example.

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

25 / 27

Heteroskedasticity
For the United States (Engle, 1983):

where h = E(2t |t‚àí1 , t‚àí2 , . . . ), PÃá = inflation, WÃá = wage change, MÃá =
money supply change.

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

26 / 27

These slides covered:
Wooldridge 12, Stock and Watson 14 and 15.

de Paula (UCL)

ECON 2007: Quantitative Economics and Econometrics

27 / 27

